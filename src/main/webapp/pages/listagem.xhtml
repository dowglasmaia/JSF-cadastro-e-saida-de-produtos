<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:b="http://bootsfaces.net/ui"
	template="/WEB-INF/template/template.xhtml">

	<ui:define name="titulo">Listagem de Produtos</ui:define>

	<!-- Chamando o Metodo Inicializar, Antes da Pagina ser carregada  -->
	<f:metadata>
		<f:viewParam
			name="Linha Apenas para resolvendo o excesso de inicializção, porque Não sei explicar rsrs"></f:viewParam>
		<f:event listener="#{produtoBean.ListarTodos()}" type="preRenderView"></f:event>
	</f:metadata>

	<!-- Inicio do Conteudo -->
	<ui:define name="conteudo">

		<div class="container">
			<p:messages id="msg" autoUpdate="true" />

			<section> <h:form id="frmSd_Produtos"
				styleClass="form-horizontal">
				<h:panelGroup>
					<!-- Deixando o Formulario Responsivel -->

					<div class="panel panel-primary">
						<div class="panel-heading">
							<h4>Listagem de Produtos</h4>
						</div>

						<div class="panel-body">
							<div class="table-responsive">

								<p:dataTable id="dtlListagem" value="#{produtoBean.produtos}"
									widgetVar="proTable" var="produto"
									emptyMessage="nenhum registro encontrado" reflow="true"
									styleClass="table" paginator="true" rows="10">



									<p:column headerText="SKU">
										<h:outputText value="#{produto.SKU}" />
									</p:column>

									<p:column headerText="Descrição">
										<h:outputText value="#{produto.descricao}" />
									</p:column>

									<p:column headerText="Marca">
										<h:outputText value="#{produto.marca}" />
									</p:column>

									<p:column headerText="Estoque">
										<h:outputText value="#{produto.estoque}" />
									</p:column>

									<p:column headerText="Valor de Custo">
										<h:outputText value="#{produto.valorCusto}" />
									</p:column>

									<p:column headerText="Baixa">
										<p:commandButton icon="ui-icon-refresh"
											update=":frmDialog:pnlProduto"
											oncomplete="PF('proDialog').show()" title="Atualizar">
											<f:setPropertyActionListener value="#{p}"
												target="#{produtoBean.produto}" />
										</p:commandButton>
									</p:column>



								</p:dataTable>
							</div>

						</div>
					</div>
				</h:panelGroup>
			</h:form> </section>

			<!-- Saida de Produtos-->
			<section> <h:form id="frmDialog" styleClass="form">
				<p:dialog header="Saída de Produtos" widgetVar="proDialog" footer=""
					styleClass="panel" modal="true" responsive="true" resizable="false">

					<p:outputPanel id="pnlProduto">

						<div class="row">
							<div class="form-group col-sm-4">
								<div class="col-sm-3 control-label">
									<h:outputLabel value="SKU:" />
								</div>
								<div class="col-sm-9">
									<h:outputText value="#{produtoBean.produto.SKU}"
										styleClass="form-control" />
								</div>
							</div>

							<div class="form-group col-sm-8">
								<div class="col-sm-4 control-label">
									<h:outputLabel value="Descrição:" styleClass="control-label" />
								</div>
								<div class="col-sm-8">

									<h:outputText value="#{produtoBean.produto.descricao}"
										styleClass="form-control" />
								</div>
							</div>
						</div>

						<div class="row">
							<div class="form-group col-sm-6">
								<div class="col-sm-3 control-label">
									<h:outputLabel value="Estoque Atual:" />
								</div>
								<div class="col-sm-9">
									<h:outputText value="#{produtoBean.produto.estoque}"
										styleClass="form-control" />
								</div>
							</div>

							<div class="form-group col-sm-6">
								<div class="col-sm-3 control-label">
									<h:outputLabel for="saida" value="Qtda Saída:" />
								</div>
								<div class="col-sm-9">
									<p:inputText id="saida" value="#{produtoBean.qtdaSaida}"
										styleClass="form-control" placeholder="Saída" size="10">
										<f:convertNumber minIntegerDigits="1" type="number" />
									</p:inputText>
								</div>
							</div>
						</div>

						<!-- Butões -->
						<div style="text-align: right;">

							<h:commandButton value="Finalizar Saída"
								styleClass="btn btn-default"
								update=":frmSd_Produtos:tblProd :msg"
								action="#{produtoBean.baixarEstoque}"
								oncomplete="PF('proDialog').hide()">

							</h:commandButton>

							<h:commandButton value="Cancelar" styleClass="btn btn-default"
								action="#{produtoBean.cancelarBaixa}" immediate="true"
								oncomplete="PF('proDialog').hide()" />
						</div>

					</p:outputPanel>
				</p:dialog>

			</h:form> </section>
		</div>
		<!-- /container -->

	</ui:define>
</ui:composition>